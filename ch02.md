# 视频格式和质量

## 2.1 引言

视频编码是对数字视频信号进行压缩和解压缩的过程。本章研究数字图像和视频信号的结构和特点，并介绍采样格式和质量度量等概念。数字视频是对自然或现实世界的视觉场景进行空间和视觉采样得到的。场景通常在某个时间点采样，以生产表示该时间点的完整视频场景的帧或通常由奇数或偶数行空间采样组成的场。通过间隔重复采样以产生运动视频信号。通常需要三元组或一些列采样点来表示场景颜色。以数字形式表示视频的流行格式包括 ITU-R 601 标准，高清晰度格式和一组“中间格式”。为了确定视觉传达系统的性能，必须衡量视觉场景再现的准确性，这是一个众所周知的困难和不精确的过程。主观测量是耗时的，并且不同的受众对视频的反映也是不同的。客观的或自动的测量更容易实现，但还不能精确地匹配人类观察者的行为。

## 2.2. 自然视频场景

真实世界或自然视频场景通常由多个对象组成，每个对象具有各自的特征形状、深度、纹理和照明。自然视频场景的颜色和亮度在整个场景中随平滑度的变换而变化，即具有连续的色调。典型的自然视频场景的特征中，与视频处理和压缩相关的特征包括空间特征、例如场景内的纹理变化、对象的数量和形状、颜色、以及时间特征（例如对象运动、照明变化和相机或视点的运动）等。

## 2.3 捕获

自然视觉场景再空间和时间上是连续的。以数字形式表示视觉场景涉及在空间上（通常在视频图像平面中的规矩网格上）和在时间上（作为以固定时间间隔采样的一些列静止帧或帧的分量）采样真实场景（如图 2.2）。数字视频是以数字形式表示采样的视频场景。每个采样点(图像元素或像素)由一个或多个数字表示，这些数字描述了亮度或色度以及采样点的颜色。

为了获得二维采样图像，摄像机将视频场景的二维投影聚焦到传感器上，例如 CCDs 阵列。彩色图像捕获的情况下，每个颜色分量被分别滤波并投影到 CCD 阵列上(如图 2.4)。

### 2.3.1 空间采样

CCD 阵列的输出是一个模拟视频信号，一个表示视频图像的可变电信号。在某个时间点对信号进行采样，生成采样图像或帧；采样图像会在采样点定义一组值。采样图像最常见的格式是矩形，采样点位于正方形或矩形网格上。图 2.3 显示了一个连续音调帧，其中叠加上两个不同的采样网格。采样发生在网格上的每个交叉点，并且可以通过将每个采样表示为正方形像素或像素来重构采样图像。采样点的数目影响图像的视觉质量。选择‘粗’采样网格(图 2.3 中的黑色网格)会产生低分辨率采样图像(图 2.4)。增加采样点的数量(图 2.3 中的灰色网格)会增加采样图像的分辨率(图 2.5)。

### 2.3.2 时间采样

运动视频图像是通过对信号进行周期性的采样形成的。回放一些列快照或帧会产生运动的现象。更高的时间采样率或帧率在视频场景中，运动会更加平滑，同时会需要更多的捕获和存储样本。帧率低于每秒 10 帧，可用于非常低比特率的视频通信，因为数据量相对较小。但在这种帧率下，运动显得不连贯。对于低比特率视频通信来说，每秒10-20帧更为典型；图像更平滑，但在序列中快速移动的部分仍然可以看出抖动。标清视频电视画面的标准是每秒 25 或 30 帧的时间采样，通过隔行扫描以改善运动的外观，见下文。每秒 50 或 60 帧以非常高的数据速率为代价产生非常平滑的视运动。

### 2.3.3 帧和场

视频信号可以作为一系列完整帧进行采样，也可以作为一系列隔行场进行隔行采样。在隔行视频序列中，通常在每个时间采样间隔对帧数据的一半(一场)进行采样。一场可以由一个完整视频帧内的奇数或偶数行组成，隔行扫描视频序列(图 2.6)通常包含一系列的场图，每场代表完整视频帧中的一半信息，描述如图 2.7 和 图 2.8 所示。这种采样方法的优势是：在相同的数据速率下，每秒可以发送两倍于等效逐行序列中帧数的场，从而使运动看起来更平滑。例如，PAL视频序列由每秒50个场组成，并且当回放时，运动看起来比每秒包含25帧的等效渐进式视频序列中的运动更平滑。视频内容以 Progressive 格式被捕获、显示的越来越多。当以一种格式（例如隔行扫描）捕获视频并以另一种格式（例如逐行扫描）显示时，需要在格式之间进行转换。

## 2.4 颜色空间

大多数数字视频应用依赖于彩色视频的显示，因此需要一种捕获和表示彩色信息的机制。单色图像（图2.1）只需要一个数字来表示每个空间样本的亮度。另一方面，彩色图像要求每个像素位置至少有三个数字才能准确地表示颜色。表示亮度和色度的方法称为颜色空间。

### 2.4.1 RGB

在 RGB 颜色空间中，彩色图像样本用三个数字表示光的三原色，数值分别表示红、绿、蓝的相对比例。把红、绿、蓝按照不同的比例组合在一起，可以创造出任何颜色。图 2.9 显示了彩色图像的红、绿、蓝分量:红色分量包好了所有的红色样本，绿色分量包含了所有绿色样本，蓝色分量包含了所有的蓝色样本。右边的人穿了一件蓝色毛衣，所以在蓝色分量中看起来更亮；而左边人物的红色背心在红色部分看起来更亮。RGB 颜色空间非常适合彩色图像的捕获和显示。捕获 RGB 图像涉及过滤掉场景中的红色、绿色和蓝色分量，并使用单独的传感器阵列捕获每个分量。彩色显示器根据每个像素分量的强度，分别照亮每个像素的红色、绿色和蓝色分量来显示 RGB 图像。从正常的观察距离来看，这些独立的组件融合在一起，呈现出“真实”的颜色。

### 2.4.2 YCrCb

人类视觉系统(HVS)对色度的敏感度低于对亮度的敏感度。在 RGB 颜色空间中，三原色都是同等重要的，因此通常以相同的分辨率存储，但通过将亮度与颜色信息分离，并以更高的的分辨率表示亮度分量，可以更有效地表示彩色图像。

## 2.5 视频格式

### 2.5.1 中间格式

本书中描述的视频压缩算法可以压缩多种视频帧格式。在实践中，通常在压缩和传输之前，将视频格式转换为一组“中间格式”中的一种。通常中间格式是表 2.1 中所列出的流行格式的基础。图 2.13 给出了不同分辨率(从 4CIF 到 Sub-QCIF)下，采样视频帧的亮度分量。帧分辨率的选择取决于应用程序和可用的存储或传输容量。例如，4CIF 适用于标清电视和 DVD 视频；CIF 和 QCIF 在视频会议应用中很流行；QCIF 或 SACIF 适用于显示分辨率和比特率受限的移动多媒体应用。

表 2.1 列出了表示各种格式中，未压缩帧所需的 bit 数；假设采样率为 4:2:0，每个亮度和色度采样率为 8bit。

### 2.5.2 标准定义

用于电视制作的数字编码视频信号的一种广泛使用的格式是 ITU-R 建议 BT.601-5。请注意，建议标题中的术语"编码"表示转换为数字格式，并不意味着压缩。视频信号的亮度分量在 13.5 MHz 处采样，色度在 6.75MHz 处采样，以产生 4:2:2(Y:Cr:Cb) 分量信号。采样数字信号的参数取决于视频帧率，NTSC 信号为 30Hz，PAL/SECAM 信号为 25Hz，如表 2.2 所示。NTSC 较高的 30Hz 帧率通过较低空间分辨率补偿，因此总的比特流在每种情况下都是相同的，均为 216Mbps。显示屏上显示的实际区域(活动区域)小于总面积，因为它排除了存在于框架边缘外部的水平和垂直间隔。

每个样本的可能范围为0-255。0和255保留用于同步，并且并且活动的亮度信号限制在16-255范围内。

### 2.5.3 高清晰度

许多高清晰度(HD)视频格式。表 2.3 列出了应用最广泛的视频显示格式，图 2.14 给出了图形化的显示。请注意，为 30Hz 的基本帧率而不是欧洲的 25Hz 的基本帧率，定义了等效版本。很显然，HD 格式需要比 SD 格式更大的未压缩存储或传输速率。SD 视频每秒有（720x576x25）个像素显示。720p高清视频每秒有(1280x720x25)个像素显示，1080p 高清视频每秒有(1920x1080x25)个像素显示。在这些分辨率下，未压缩视频需要非常大的存储或传输容量，这意味着压缩视频对于实际应用是必不可少的。

## 2.6 质量

为了指定、评估和比较视频通信系统，有必要确定显示给观看者的视频图像的质量。测试时间质量是一门非常困难而且往往并不精确的艺术，因为有太多的因素会影响结果。视觉质量本质上是非常主观的，因此受到许多主观因素的影响，很难获得完全准确的质量度量。例如，观众对视觉质量的看法在很大程度上取决于手头的任务，例如被动地观看DVD电影、积极地参加视频会议或试图在监控视频场景中识别某人。使用客观标准测量视觉质量可以得到准确的、可重复的结果，但目前还没有一种客观的测量系统能够完全再现人类观察者观看视频显示的主观体验。

### 2.6.1 主观质量测量

#### 2.6.1.1 影响主观质量的因素

我们对视觉场景的感知是由人类视觉系统（HVS）的组成部分、眼睛和大脑之间的复杂交互作用形成的。视觉质量的感知受到空间保真度和时间保真度的影响；空间保真度是指即可以看到场景的各个部分有多清晰，是否有任何明显的失真，时间保真度是指运动是否显得自然和“平滑”。然而，观众对“质量”的看法也受到其他因素的影响，如观看环境、观察者的心理状态以及观察者与视觉场景互动的程度。执行特定任务的用户需要专注于视觉场景的一部分，与被动观看电影的用户相比，他们对质量的要求会有很大的不同。研究表明，无论视觉图像本身的质量如何，只要观看环境舒适且不分散注意力，观看者对视觉质量的评价就会明显提高。

对感知质量的其他重要影响包括视觉注意和所谓的近距效应。视觉注意是指观察者通过注视图像中的一系列点而不是同时摄取所有东西来感知场景的方式；近距效应是指，我们对视觉序列的看法受最近观看的材料的影响比旧的视频材料更大。所有这些因素都使得视觉质量的精确定量测量变得非常困难。

#### 2.6.1.2 ITU-R 500

ITU-R 500 中定义了几种主观质量评估的测试程序。该标准中最常用的程序是 **the Double Stimulus Continuous Quality Scale(DSCQS)** 方法。该方法中，评估者被依次呈现一对图像或短视频序列 A 和 B，并被要求给 A 和 B 一个质量分数，在一条连续的线上打上从优秀到差的五个区间。一个典型的测试过程中，评测员会被成对的展示序列视频，并被要求为每对序列打分。在每一对序列中，一个是未损坏的“参考”序列，另一个又被测系统或过程修改了的相同的序列视频。图 2.15 显示了一个适合视频编解码器测试的实验装置，其中原始序列与编码、解码后的序列进行比较。显示时，选择 A 或 B，是随机的。

两序列(原始序列和受损序列)在测试过程中的顺序是随机的，以便评估员不知道哪个是原始序列，哪个是受损序列。这有助于防止评估员预先判断受损序列和参考序列。在评估过程的最后，分数被转换为标准化范围，最终结果是一个得分，有时被称为"平均意见分数(MOS)"，它表明了受损序列和参考序列的相对质量。

像 **DSCQS** 这样的测试被认为是主观视觉质量的真实度量。然而，这种类型的测试存在实际问题。取决于测试序列和评估人员的不同，结果可能会有非常大的差异。这种变化，可以通过重复几个序列和几个评估员的测试来补偿。熟悉视频压缩失真的'专家'评估员可能会给出有偏见的分数，建议使用非专家评估员。这意味着需要大量的评估人员，因为非专家评估人员将很快学会识别视频序列中的特征人工制品，从而成为“专家”。这些因素使得彻底执行DSCQS测试既昂贵又耗时。

### 2.6.2 客观质量测量

主观质量测量的复杂性和成本，使得能够使用一种算法自动测量质量，变得非常有吸引力。视频压缩和视频处理系统的开发人员严重依赖于所谓的目标(算法)质量度量。使用最广泛的测量方法是峰值信噪比(PSNR)，但该指标的局限性，使得许多人努力开发更复杂的衡量标准，以接近“真实”人类观察者的反应。

#### 2.6.2.1 PSNR

#### 2.6.2.2 其他可观质量指标

## 2.7 总结

对模拟视频进行采样，产生数字视频信号，该信号具有精度、质量以及与数字媒体和传输兼容的优点，但通常占用非常大的比特率。数字视频系统固有的问题包括空间和时间分辨率、颜色表示和视频质量的测量。下一章将介绍视频压缩的基本概念，这是在实际存储和传输媒体上容纳数字视频信号所必须的。
